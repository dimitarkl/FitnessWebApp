<div class="flex justify-center items-center box-border border-gray-700 rounded-lg py-4 px-6 my-4">
	<div class="w-full max-w-4xl bg-dark-blue rounded-lg shadow-sm">
		<div class="p-6 text-gray-100 ">
			<div class="flex flex-row md:flex-row items-start justify-between gap-4 mb-6">
				<div class="flex flex-col md:flex-row items-center gap-4">
					<img src="avatar.png" alt="Profile Photo"
						class="w-14 h-14 rounded-full object-cover border border-gray-600" />
					<div>
						<h1 class="font-bold text-2xl text-gray-100">
							{{ ownerUsername ? ownerUsername : "User Not Found" }}
						</h1>
						<p class="text-sm text-gray-400">
							{{ workout?.createdAt | relativeDate }}
						</p>
					</div>
				</div>
				<div class="flex flex-col justify-center items-center">
					<div class="flex flex-col items-end gap-2">
						@if(workout?.ownerId != currentUser?.id && currentUser &&
						!workout?.likes?.includes(currentUser.id)) {
						<button type="button" (click)="likePost()"
							class="px-4 py-2 bg-accent-green hover:bg-green-600 text-white rounded-lg transition-colors flex items-center gap-2">
							<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
									d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z">
								</path>
							</svg>
							Like
						</button>
						}


					</div>
					@if(isOwner()) {
					<div class="flex gap-2">
						<button (click)="editWorkout()"
							class="px-4 py-2 bg-slate-600 hover:bg-slate-700 text-white rounded-lg transition-colors flex items-center gap-2">
							<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
									d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z">
								</path>
							</svg>
							Edit
						</button>
						<button (click)="confirmDelete()"
							class="px-4 py-2 bg-rose-600 hover:bg-rose-700 text-white rounded-lg transition-colors flex items-center gap-2">
							<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
									d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
								</path>
							</svg>
							Delete
						</button>
					</div>
					}

					<!-- Likes display -->
					<button class=" m-2 flex gap-1 ">
						@if(workout?.likes?.includes(currentUser?.id || '')) {

						<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-5 h-5 fill-red-500">
							<path
								d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z" />
						</svg>
						} @else {

						<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
							class="w-5 h-5 fill-none stroke-current" stroke-width="10">
							<path
								d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z" stroke="currentColor"/>
						</svg>
						}
						@if(workout?.likes?.includes(currentUser?.id || '')) {
						<span class="text-red-500">{{ workout?.likes?.length}}</span>
						} @else {
						<span class="text-accent-green">{{ workout?.likes?.length}}</span>
						}
					</button>
				</div>
			</div>


			<div class="mb-6 ">
				<h2 class="text-xl font-semibold mb-4 text-gray-100">
					{{ workout?.title }}
				</h2>


				<div class="grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gray-800 rounded-lg">
					<div class="text-center">
						<p class="text-2xl font-bold text-accent-green">{{ workout?.exercises?.length || 0 }}</p>
						<p class="text-sm text-gray-400">Exercises</p>
					</div>
					<div class="text-center">
						<p class="text-2xl font-bold text-accent-green">{{ getTotalSets() }}</p>
						<p class="text-sm text-gray-400">Total Sets</p>
					</div>
					<div class="text-center">
						<p class="text-2xl font-bold text-accent-green">{{( workout?.duration ?? 0) | duration }}</p>
						<p class="text-sm text-gray-400">Duration</p>
					</div>
					<div class="text-center">
						<p class="text-2xl font-bold text-accent-green">
							{{ getTotalVolume() | number:'1.0-0' }}{{ prefUnit === "kg" ? " kg" : " lbs" }}
						</p>
						<p class="text-sm text-gray-400">Total Volume</p>
					</div>
				</div>
			</div>

			<!-- Exercises -->
			@for(exercise of workout?.exercises; track $index) {
			<div class="mb-6 bg-gray-800 rounded-lg">
				<app-exercise-card [exercise]="exercise" [class]="class"></app-exercise-card>

				<!-- Sets display -->
				@for(set of exercise.sets; track $index) {
				<div class="grid grid-cols-3 gap-4 p-3 rounded-lg  text-center  text-gray-100 mt-2">
					<div>
						@if($index == 0) {
						<h1 class="font-semibold text-accent-green uppercase text-sm mb-1">
							Set
						</h1>
						}
						<p class="text-lg">{{ $index + 1 }}</p>
					</div>
					<div>
						@if($index == 0) {
						<h1 class="font-semibold text-accent-green uppercase text-sm mb-1">
							Reps
						</h1>
						}
						<p class="text-lg">{{ set.reps }}</p>
					</div>
					<div>
						@if($index == 0) {
						<h1 class="font-semibold text-accent-green uppercase text-sm mb-1">
							Weight
						</h1>
						}
						<p class="text-lg">
							{{
							prefUnit === "kg"
							? set.weight + " kg"
							: set.weight + " lbs"
							}}
						</p>
					</div>
				</div>
				}
			</div>
			}
		</div>
	</div>
</div>

<!-- Delete Confirmation Modal -->
<app-delete-confirmation-modal [isVisible]="showDeleteConfirm" title="Confirm Delete"
	message="Are you sure you want to delete this workout? This action cannot be undone." [isDeleting]="isDeleting"
	(confirmed)="deleteWorkout()" (cancelled)="cancelDelete()">
</app-delete-confirmation-modal>