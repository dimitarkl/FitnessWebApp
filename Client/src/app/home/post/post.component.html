<div class="post-wrapper">
    
    <div class="post-card">
        <div class="post-header">
            <div class="flex">
                <img src="avatar.png" alt="Profile Photo"
                    class="w-12 h-12 rounded-full object-cover border-2 border-gray-600" />
                <h1 class="font-bold text-2xl mt-1.5 ml-2">
                    {{ ownerUsername ? ownerUsername : "" }}
                </h1>
            </div>
            <div class="date-wrapper">
                <div class="w-4 mr-2">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                        <path fill="white"
                            d="M128 0c17.7 0 32 14.3 32 32l0 32 128 0 0-32c0-17.7 14.3-32 32-32s32 14.3 32 32l0 32 48 0c26.5 0 48 21.5 48 48l0 48L0 160l0-48C0 85.5 21.5 64 48 64l48 0 0-32c0-17.7 14.3-32 32-32zM0 192l448 0 0 272c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 192zm64 80l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0c-8.8 0-16 7.2-16 16zm128 0l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0c-8.8 0-16 7.2-16 16zm144-16c-8.8 0-16 7.2-16 16l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0zM64 400l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0c-8.8 0-16 7.2-16 16zm144-16c-8.8 0-16 7.2-16 16l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0zm112 16l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0c-8.8 0-16 7.2-16 16z" />
                    </svg>
                </div>
                <h2 class="text-lg ">
                    {{(workout?.createdAt ?? null ) | relativeDate}}
                </h2>
            </div>
        </div>

        <div class="title-duration">
            <p class="text-xl">{{ workout?.title }}</p>
            <div class="flex flex-row gap-1 items-center">
                <div class="w-4">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                        <path fill="white"
                            d="M256 0a256 256 0 1 1 0 512A256 256 0 1 1 256 0zM232 120l0 136c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2 280 120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" />
                    </svg>
                </div>
                <p class="text-xl"> {{(workout?.duration ?? 0) | duration}}</p>
            </div>
        </div>
        <div class="exercises-wrapper">
            <div class="flex flex-row mb-2 justify-center items-center">
                <div class="w-6 mr-1.5">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512">
                        <path fill="white"
                            d="M96 64c0-17.7 14.3-32 32-32l32 0c17.7 0 32 14.3 32 32l0 160 0 64 0 160c0 17.7-14.3 32-32 32l-32 0c-17.7 0-32-14.3-32-32l0-64-32 0c-17.7 0-32-14.3-32-32l0-64c-17.7 0-32-14.3-32-32s14.3-32 32-32l0-64c0-17.7 14.3-32 32-32l32 0 0-64zm448 0l0 64 32 0c17.7 0 32 14.3 32 32l0 64c17.7 0 32 14.3 32 32s-14.3 32-32 32l0 64c0 17.7-14.3 32-32 32l-32 0 0 64c0 17.7-14.3 32-32 32l-32 0c-17.7 0-32-14.3-32-32l0-160 0-64 0-160c0-17.7 14.3-32 32-32l32 0c17.7 0 32 14.3 32 32zM416 224l0 64-192 0 0-64 192 0z" />
                    </svg>
                </div>
                <h3 class="text-2xl">
                    Exercises:
                </h3>
            </div>
            
            @for(exercise of workout?.exercises?.slice(0, 3); track $index) {
            <app-exercise-card [exercise]="exercise" [class]="class"></app-exercise-card>
            }
        </div>

        @if(more > 0) {
        <div class="text-center">
            <a routerLink="/details/{{ workout?.id }}" class="text-accent-green">
                Click To See The Full Workout({{ more }} more left)
            </a>
        </div>
        } @else {
        <div class="text-center">
            <a routerLink="/details/{{ workout?.id }}" class="text-accent-green">
                Click To See The Full Workout
            </a>
        </div>
        }
        <button  class="mx-3 flex items-center gap-1">
            @if(workout?.likes?.includes(user?.id || '')) {
            <!-- Filled heart for liked posts -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-5 h-5 fill-red-500" >
                <path d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/>
            </svg>
            } @else {
            <!-- Outline heart for non-liked posts -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-5 h-5 fill-none stroke-current" stroke-width="10">
                <path d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z" stroke="currentColor"/>
            </svg>
            }
            @if(workout?.likes?.includes(user?.id || '')) {
            <span class="text-red-500">{{ workout?.likes?.length}}</span>
            } @else {
            <span class="text-accent-green">{{ workout?.likes?.length}}</span>
            }
        </button>
        <div class="mt-4 flex space-x-2">
            @if(workout?.ownerId != user?.id && user &&
            !workout?.likes?.includes(user.id)) {
            <button 
            type="button"
            (click)="likePost()"
                class="px-4 py-2 bg-accent-green hover:bg-green-600 text-white rounded-lg transition-colors flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z">
                    </path>
                </svg>
                Like
            </button>
            }
            @if(workout?.ownerId == user?.id) {
            <a routerLink="/edit/{{ workout?.id }}"
                class="px-4 py-2 bg-slate-600 hover:bg-slate-700 text-white rounded-lg transition-colors flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z">
                    </path>
                </svg>
                Edit
            </a>
            <button
                (click)="confirmDelete()"
                class="px-4 py-2 bg-rose-600 hover:bg-rose-700 text-white rounded-lg transition-colors flex items-center gap-2"
                [disabled]="isDeleting">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                    </path>
                </svg>
                Delete
            </button>
            }
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<app-delete-confirmation-modal
    [isVisible]="showDeleteConfirm"
    title="Delete Workout"
    message="Are you sure you want to delete this workout? This action cannot be undone."
    [isDeleting]="isDeleting"
    (confirmed)="deleteWorkout()"
    (cancelled)="cancelDelete()">
</app-delete-confirmation-modal>